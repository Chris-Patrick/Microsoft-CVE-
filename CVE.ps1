param(

    [string]$OutputFilePath = "C:\Users\Public\Desktop\MSRCOutput.csv"

)

 

Install-Module -Name MsrcSecurityUpdates -Force

Import-Module -Name MsrcSecurityUpdates -Force

 

# Define an array of month IDs

$Month = Read-Host 'Enter year and month to lookthrough (EX: 2020-Jan or 2020-Jan, 2020-Feb)'

$MonthIDs = $Month.Split(',').Trim()

 

$cvrfDocument = Get-MsrcCvrfDocument -ID 2024-Jan   

$index = Get-MsrcCvrfExploitabilityIndex -Vulnerability $cvrfDocument.Vulnerability

 

foreach ($monthID in $MonthIDs) {

    $summary = Get-MsrcCvrfDocument -ID $monthID | Get-MsrcCvrfCVESummary

 

    $cv = $summary | Where-Object { ($_."Maximum Severity Rating" -eq 'Important') -or ($_."Maximum Severity Rating" -eq 'Critical') }

 

    $cv | ForEach-Object {

        $cve = $_.CVE

        $description = $_.Description

        $maxSeverity = $_."Maximum Severity Rating"

        $impact = $_."Vulnerability Impact"

        #$affectedSoftware = $_."Affected Software" | Where-Object { $_ -like "*Windows 10 Version 1809 for x64*" }

 

        if ($affectedSoftware) {

            $output = @"

 

Month: $monthID

CVE : $cve

Title :

Description : $description

Maximum Severity Rating : $maxSeverity

Vulnerability Impact : $impact

Affected Software : $affectedSoftware

 

"@

            Write-Output $output

            $output | Out-File -FilePath $OutputFilePath -Append

        }

    }

}
